## 共享数据

`数据竞争`是未定义行为的起因, 保护共享数据结构的最基本的方式，使用C++标准库提供的互斥量

- [互斥量](../chap3/mutex.cpp)</br>
  某些情况下使用全局变量没问题，但大多数情况下， `互斥量通常会与需要保护的数据放在同一类中`，而不是定义成全局变量。这是面向对象设计的准则：将其放在一个类中，就可让他们联系在一起，也可对类的功能进行封装，并进行数据保护
- [线程安全stack](../chap3/t_stack.cpp)
  - `问题原因`</br>
    系统负载高时可能会因为内存分配失败而导致异常。栈中的数据已经被移除，但在获取数据副本的过程中，如果抛出了异常，栈中的数据就会丢失
  - 设计方法：
    - `传递引用参数` </br>
        `voidpop(T&value)` 可以避免了拷贝构造和异常问题（如果返回值的话），因为传递的是引用
    - `返回指针`</br>
        返回指向弹出元素的指针，而不是直接返回元素本身,可以避免拷贝过程中的异常，因为我们只是返回了一个指向原始数据的指针，而没有进行内存分配和拷贝,并且使用智能指针还可以管理内存分配和生命周期，可以避免内存泄露
- [死锁](../chap3/dead_lock.cpp)
